(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     76407,       1809]
NotebookOptionsPosition[     70526,       1714]
NotebookOutlinePosition[     70975,       1734]
CellTagsIndexPosition[     70932,       1731]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[{
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " HEOM, general method with Matsubara frequencies and multiple baths per site"
}], "Title",
 CellChangeTimes->{{3.628153992539587*^9, 3.628153999273828*^9}, {
  3.628608221975856*^9, 3.628608229651675*^9}, {3.63144041304438*^9, 
  3.631440419898644*^9}, {3.666504226322857*^9, 3.6665042418167553`*^9}, {
  3.667023858492427*^9, 3.667023889609127*^9}, {3.772854164416667*^9, 
  3.7728541699744787`*^9}},ExpressionUUID->"b3386616-d619-4d08-87f8-\
2dcc43940a47"],

Cell[TextData[{
 "Written on 26.12.2014 by Tobias Kramer (email: tobias.kramer@mytum.de), \
tidied up 2014-2019\nThis notebook implements the HEOM algorithm as described \
in \n[R1] Tanimura & Kubo \[OpenCurlyDoubleQuote]Time Evolution of a Quantum \
System in Contact with a Nearly Gaussian-Markoffian Noise Bath\
\[CloseCurlyDoubleQuote], J. Phys. Soc. Jpn. 58, pp. 101-114 (1989) \n[R2] \
Tanimura  \[OpenCurlyDoubleQuote]Stochastic Liouville, Langevin, \
Fokker\[Dash]Planck, and Master Equation Approaches to Quantum Dissipative \
Systems\[CloseCurlyDoubleQuote], J. Phys. Soc. Jpn. 75, 082001 (2006)\n[R3] \
Kreisbeck & Kramer \[OpenCurlyDoubleQuote]Long-Lived Electronic Coherence in \
Dissipative Exciton Dynamics of Light-Harvesting Complexes\
\[CloseCurlyDoubleQuote], J. Phys. Chem. Lett.319 2828-2833 (2012)\n[R4] \
Kramer et al: \[OpenCurlyDoubleQuote]Efficient calculation of open quantum \
system dynamics and time\[Hyphen]resolved spectroscopy with distributed \
memory HEOM (DM\[Hyphen]HEOM)\[CloseCurlyDoubleQuote]\nand further references \
therein.\n",
 StyleBox["If you use this notebook for your research, please acknowledge \
this implementation and share your modifications publicly.",
  FontWeight->"Bold"]
}], "Text",
 CellChangeTimes->{{3.628154003297536*^9, 3.628154012864895*^9}, {
  3.6283098570607023`*^9, 3.628309934284301*^9}, {3.628403651600399*^9, 
  3.628403654164763*^9}, {3.628608656750842*^9, 3.628608661821927*^9}, {
  3.666245172064272*^9, 3.666245206743594*^9}, {3.667023895161111*^9, 
  3.667023899728662*^9}, {3.685534301604704*^9, 3.685534312099996*^9}, {
  3.772854185639954*^9, 3.772854326952745*^9}, {3.7728710668177757`*^9, 
  3.772871091873054*^9}, {3.773456147797758*^9, 3.7734563360861073`*^9}, {
  3.773456480933333*^9, 3.7734565130108*^9}, {3.77345654449755*^9, 
  3.773456611247365*^9}},ExpressionUUID->"19543ba8-7302-49e2-ab87-\
f782ff7641af"],

Cell[CellGroupData[{

Cell["Physical constants", "Section",
 CellChangeTimes->{{3.772854357538986*^9, 
  3.772854361775179*^9}},ExpressionUUID->"acdfa906-649a-4369-8aee-\
68f2ec0741a4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[HBar]SI", "=", "1.05457148`200*^-34"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
  "kBSI", "=", 
   "1.380650239684840458953781387048428305608616777679979316`200.*^-23"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
  "invcmtoJoule", "=", 
   "1.986456217327470903861498336971100097137908380913187891`200.*^-23"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7728543626260242`*^9, 3.772854362627408*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"b102d30c-b7e1-4ddb-aebe-ea5bcc17765d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PRECISION", "=", "$MachinePrecision"}], ";"}]], "Input",
 CellChangeTimes->{{3.6283120282324057`*^9, 3.628312031597055*^9}, {
  3.628320605110236*^9, 3.628320605127863*^9}, {3.666502298200511*^9, 
  3.666502298291901*^9}, {3.685532680868936*^9, 3.685532682128847*^9}, {
  3.6855339456600847`*^9, 3.685533946698819*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"60529da6-da5d-4891-b847-a7f324b5cd30"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Basic parameters of the system and baths", "Section",
 CellChangeTimes->{{3.628154037838068*^9, 3.628154040349762*^9}, {
  3.666502120499275*^9, 3.666502126049521*^9}, {3.7728543894158907`*^9, 
  3.7728543952778883`*^9}},ExpressionUUID->"80570d05-3acc-47ce-baa9-\
22353866f662"],

Cell[CellGroupData[{

Cell["Hamiltonian (system part)", "Subsubsection",
 CellChangeTimes->{{3.666502384776897*^9, 3.666502387871582*^9}, {
  3.772855069919422*^9, 
  3.7728550958527927`*^9}},ExpressionUUID->"58bc4453-c91b-4b88-ad40-\
0dc4d28661b2"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SITES", "=", "2"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Number", " ", "of", " ", "sites"}], ",", " ", 
    RowBox[{
    "including", " ", "ground", " ", "state", " ", "and", " ", "double", " ", 
     "exciton", " ", "states"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.6670309537664747`*^9, 3.667030953816143*^9}, {
  3.6670366981075077`*^9, 3.66703669846581*^9}, {3.667100457129767*^9, 
  3.667100457189705*^9}, {3.667100890333572*^9, 3.66710089039399*^9}, {
  3.685532684675145*^9, 3.68553268476924*^9}, {3.772854450404216*^9, 
  3.7728544641977587`*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"1afe8aa8-9514-410e-892c-0cf5a7fbd55c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Hex", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"100", ",", "50"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"50", ",", "200"}], "}"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.666502325060789*^9, 3.6665023406153917`*^9}, {
  3.667030956968646*^9, 3.6670309871360598`*^9}, {3.6670367072904377`*^9, 
  3.667036710081725*^9}, {3.6671004595518637`*^9, 3.667100461214137*^9}, {
  3.667100892856995*^9, 3.667100909674816*^9}, {3.685532690619855*^9, 
  3.685532699976996*^9}, {3.772854816490982*^9, 3.772854817767867*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"7b8fa453-69a8-4b98-a8a9-11d87b665293"],

Cell["\<\
This is the complete Hamiltonian, including ground state and 2 exciton states\
\
\>", "Text",
 CellChangeTimes->{{3.666502352624908*^9, 
  3.666502369760179*^9}},ExpressionUUID->"84339a21-566d-4d12-96c2-\
fa5c6f86e96c"],

Cell[BoxData[
 RowBox[{"Hex", "//", "MatrixForm"}]], "Input",
 CellLabel->"In[7]:=",ExpressionUUID->"b6ef50fc-6a0e-46f2-b63f-d12e5f7957e8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"HMSI", "=", 
   RowBox[{"SetPrecision", "[", 
    RowBox[{
     RowBox[{"Hex", "*", "invcmtoJoule"}], ",", "PRECISION"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{3.628340107826885*^9},
 CellLabel->"In[8]:=",ExpressionUUID->"c08f55d6-f8a4-4a80-b9d6-b9f58dd34e53"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Integration time step", "Subsubsection",
 CellChangeTimes->{{3.666502384776897*^9, 3.666502387871582*^9}, {
  3.772855069919422*^9, 
  3.772855073293339*^9}},ExpressionUUID->"88fe139b-10ca-4dcc-848e-\
4db4e8000a0d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"hSI", "=", 
    RowBox[{"SetPrecision", "[", 
     RowBox[{
      RowBox[{"5", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "15"}]]}], ",", "PRECISION"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"time", "-", 
    RowBox[{"step", " ", "for", " ", 
     RowBox[{"integration", " ", "[", "s", "]"}]}]}], " ", "*)"}]}]], "Input",\

 CellChangeTimes->{{3.772854951987994*^9, 3.772854959882071*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"c78a8584-496a-4d23-8ebe-4221ea6308a8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Bath parameters", "Subsubsection",
 CellChangeTimes->{{3.666502384776897*^9, 
  3.666502387871582*^9}},ExpressionUUID->"18970398-d1a7-46b0-953f-\
e09ecfab1d7b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"NMAX", "=", "4"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"HEOM", " ", "truncation", " ", "depth"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MATSUBARAS", "=", "1"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Number", " ", "of", " ", "Matsubara", " ", "frequencies"}], " ", 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.6670240896272993`*^9, 3.667024130923751*^9}, {
  3.675048119957458*^9, 3.67504811999923*^9}, {3.685533797260915*^9, 
  3.685533799937335*^9}, {3.6855342173826733`*^9, 3.6855342174526854`*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"f80e052e-3609-4cd6-b56f-145f27df9764"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TSI", "=", "200"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"temperature", ",", " ", 
    RowBox[{"common", " ", "to", " ", "all", " ", 
     RowBox[{"baths", " ", "[", "K", "]"}]}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Nu]inv", "=", 
    RowBox[{"50", "*", 
     SuperscriptBox["10", 
      RowBox[{"-", "15"}]]}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"inverse", " ", "bath", " ", "correlation", " ", 
    RowBox[{"time", " ", "[", "s", "]"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Lambda]invcm", "=", "15"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"reorganization", " ", 
    RowBox[{"energy", " ", "[", 
     RowBox[{"1", "/", "cm"}], "]"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalOmega]invcm", "=", "0"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "shift", " ", "of", " ", "spectral", " ", "density", " ", "peak"}], ",", 
    " ", 
    RowBox[{
     RowBox[{"use", " ", "pairs", " ", "of", " ", "peaks"}], " ", "+", 
     RowBox[{
      RowBox[{"/", 
       RowBox[{"-", " ", "shifted"}]}], " ", "for", " ", "building", " ", 
      "structured", " ", "J", 
      RowBox[{"(", "\[Omega]", ")"}]}]}]}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.628310313034944*^9, 3.628310315833333*^9}, {
   3.628310359908875*^9, 3.6283104065681047`*^9}, 3.6283108017496023`*^9, {
   3.6283119304956512`*^9, 3.6283119329845543`*^9}, {3.628312036058277*^9, 
   3.628312040111792*^9}, {3.62831213636642*^9, 3.628312149627396*^9}, 
   3.628317055235029*^9, 3.628317473656288*^9, {3.6283177033834476`*^9, 
   3.6283177169620047`*^9}, 3.628318088797299*^9, {3.6283181607374773`*^9, 
   3.6283181608326197`*^9}, {3.628318344985957*^9, 3.62831837401621*^9}, {
   3.6283205498996363`*^9, 3.628320549916627*^9}, {3.628320662558113*^9, 
   3.628320662625496*^9}, {3.628320708359597*^9, 3.628320709473124*^9}, {
   3.628404940709504*^9, 3.6284049408998003`*^9}, {3.628412047142333*^9, 
   3.628412047298634*^9}, {3.628412765668997*^9, 3.628412765794519*^9}, {
   3.628412837730575*^9, 3.628412840986991*^9}, {3.6284129031747017`*^9, 
   3.628412909710259*^9}, {3.628413256686717*^9, 3.628413256747909*^9}, {
   3.628415238990778*^9, 3.628415239127521*^9}, {3.628415656454546*^9, 
   3.6284156565804853`*^9}, 3.628415961654025*^9, 3.628417248452977*^9, {
   3.628418291299705*^9, 3.6284182932151337`*^9}, {3.628450178135229*^9, 
   3.628450178218104*^9}, {3.628450528026598*^9, 3.628450528843791*^9}, {
   3.628450599761361*^9, 3.62845060026579*^9}, {3.628570854387376*^9, 
   3.628570855081601*^9}, {3.628578677372355*^9, 3.628578677548091*^9}, {
   3.628579223708354*^9, 3.628579253163424*^9}, {3.628579336628509*^9, 
   3.628579336818018*^9}, {3.628579418713232*^9, 3.628579418871908*^9}, {
   3.628592023567915*^9, 3.6285920246716633`*^9}, {3.628592070848476*^9, 
   3.628592070987793*^9}, {3.628592252753244*^9, 3.628592253095048*^9}, {
   3.628592287974889*^9, 3.62859228811664*^9}, {3.628594558291148*^9, 
   3.6285945585251637`*^9}, {3.628594590928527*^9, 3.628594597086378*^9}, 
   3.628595963367977*^9, 3.628596172146264*^9, {3.62860359899116*^9, 
   3.628603600117333*^9}, {3.62860365599734*^9, 3.6286036864103727`*^9}, {
   3.66619235845455*^9, 3.666192363029826*^9}, {3.6855338027860947`*^9, 
   3.685533802807385*^9}, {3.685534020694873*^9, 3.6855340207811937`*^9}, {
   3.6855340564985113`*^9, 3.685534056600176*^9}, {3.7728548361772623`*^9, 
   3.772854926707795*^9}, {3.773143673123447*^9, 3.773143673175569*^9}, {
   3.773143952925398*^9, 3.773143952962686*^9}, {3.773144302266478*^9, 
   3.773144303544055*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"67b1c366-1bfa-4da0-8666-58eb3bf757f1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Beta]SI", "=", 
   RowBox[{"SetPrecision", "[", 
    RowBox[{
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{"kBSI", " ", "TSI"}], ")"}]}], ",", "PRECISION"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Nu]1SI", "=", 
   RowBox[{"SetPrecision", "[", 
    RowBox[{
     RowBox[{"2", 
      RowBox[{"\[Pi]", "/", 
       RowBox[{"(", 
        RowBox[{"\[Beta]SI", " ", "\[HBar]SI"}], ")"}]}]}], ",", 
     "PRECISION"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Nu]SI", "=", 
   RowBox[{"SetPrecision", "[", 
    RowBox[{
     RowBox[{"1", "/", "\[Nu]inv"}], ",", "PRECISION"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]SI", "=", 
   RowBox[{"SetPrecision", "[", 
    RowBox[{
     RowBox[{"\[Lambda]invcm", "*", "invcmtoJoule"}], ",", "PRECISION"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalOmega]SI", "=", 
   RowBox[{"SetPrecision", "[", 
    RowBox[{
     RowBox[{"\[CapitalOmega]invcm", "*", 
      RowBox[{"invcmtoJoule", "/", "\[HBar]SI"}]}], ",", "PRECISION"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6283102786399927`*^9, 3.6283103300177183`*^9}, {
   3.628310524886909*^9, 3.628310586827011*^9}, {3.6283109866115913`*^9, 
   3.628310986778545*^9}, 3.628311800443203*^9, 3.628311934643057*^9, {
   3.6283120758371477`*^9, 3.628312103231514*^9}, {3.628313214017524*^9, 
   3.628313244216037*^9}, {3.628340101034667*^9, 3.6283401017007647`*^9}, {
   3.6284051966714373`*^9, 3.628405198074128*^9}, {3.628412204892721*^9, 
   3.62841220509695*^9}, {3.628592049656106*^9, 3.628592049925235*^9}, {
   3.666199740656493*^9, 3.666199740742179*^9}, {3.666199829859604*^9, 
   3.666199829937593*^9}, {3.666500349439801*^9, 3.666500349646153*^9}, 
   3.666961601793841*^9, {3.667019272134161*^9, 3.667019272429968*^9}, 
   3.667023041451339*^9, {3.6750482630422287`*^9, 3.6750482633138514`*^9}, {
   3.685533854514534*^9, 3.6855338550806093`*^9}, {3.772854941967248*^9, 
   3.7728549429883757`*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"777320bd-9980-4c84-91ea-356e0c4cd599"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"NUMBATHS", "=", "2"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "total", " ", "number", " ", "of", " ", "independent", " ", "baths"}], " ",
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MAXBATHSPERSITE", "=", "1"}], " ", ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{
   "maximum", " ", "number", " ", "of", " ", "baths", " ", "coupling", " ", 
    "to", " ", "a", " ", "site"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BASTable", "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "0", "}"}], ",", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"C", "++"}], " ", "indexing", " ", "starts", " ", "at", " ",
           "site", " ", "0"}], " ", "=", " ", 
         RowBox[{"ground", " ", "state"}]}], ",", " ", 
        RowBox[{
         RowBox[{"-", "1"}], " ", "indicates", " ", "NO", " ", "coupling"}]}],
        " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"{", "1", "}"}]}], "}"}]}], ";"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "for", " ", "compatibility", " ", "construct", " ", "also", " ", "the", 
    " ", "reverse", " ", 
    RowBox[{"map", ":"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"coupling", ":", " ", 
     RowBox[{
      RowBox[{"bath2sites", "[", 
       RowBox[{"[", "b", "]"}], "]"}], "[", 
      RowBox[{"[", "s", "]"}], "]"}]}], " ", "\[Rule]", " ", 
    RowBox[{
    "bath", " ", "b", " ", "is", " ", "coupled", " ", "to", " ", "site", " ", 
     "s"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"bath2sites", "=", 
  RowBox[{"DeleteCases", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Flatten", "[", 
       RowBox[{"Drop", "[", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"BASTable", ",", "s"}], "]"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"-", "1"}]}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"s", ",", "0", ",", 
        RowBox[{"SITES", "-", "1"}]}], "}"}]}], "]"}], ",", 
    RowBox[{"{", "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.628154041256555*^9, 3.628154097582037*^9}, {
   3.628154543611178*^9, 3.628154545730208*^9}, {3.628156083314438*^9, 
   3.6281560834036217`*^9}, {3.628156149680586*^9, 3.62815615000949*^9}, {
   3.6281575859804983`*^9, 3.628157586381531*^9}, {3.628171069103382*^9, 
   3.628171069220951*^9}, {3.62817415732054*^9, 3.628174157472042*^9}, {
   3.628174569430059*^9, 3.628174569488838*^9}, {3.6281748373619413`*^9, 
   3.628174837517717*^9}, {3.6281755090460463`*^9, 3.62817551152118*^9}, {
   3.628175903902835*^9, 3.6281759060405483`*^9}, {3.6281767486649437`*^9, 
   3.628176748838758*^9}, {3.628177998767983*^9, 3.628177998959588*^9}, {
   3.62817804230718*^9, 3.628178042500491*^9}, {3.628178110100786*^9, 
   3.628178110332299*^9}, {3.6281784175937767`*^9, 3.6281784177811823`*^9}, {
   3.6281784500708523`*^9, 3.6281784517767773`*^9}, {3.628179069676587*^9, 
   3.6281790697409554`*^9}, 3.628180421538378*^9, {3.628181214226416*^9, 
   3.628181214396925*^9}, {3.628181676349783*^9, 3.628181677366335*^9}, {
   3.628182062065695*^9, 3.62818206492143*^9}, {3.628182295066387*^9, 
   3.628182318264853*^9}, {3.628182383843004*^9, 3.628182385371284*^9}, {
   3.628182805394799*^9, 3.6281828063414307`*^9}, {3.628185951868476*^9, 
   3.628185952615679*^9}, {3.628241330954897*^9, 3.6282413310490417`*^9}, {
   3.628271023635078*^9, 3.628271063932272*^9}, {3.6282735914153748`*^9, 
   3.6282736188524427`*^9}, {3.628274645435009*^9, 3.628274647854352*^9}, {
   3.62831746734503*^9, 3.6283174674551277`*^9}, {3.628339850808859*^9, 
   3.628339850836875*^9}, {3.628339976033577*^9, 3.628339977348207*^9}, {
   3.6283403285368443`*^9, 3.6283403285751057`*^9}, {3.6283403924797*^9, 
   3.62834039270757*^9}, {3.628340453524831*^9, 3.628340454808927*^9}, {
   3.6283405576032763`*^9, 3.6283405577750673`*^9}, {3.6283408029933653`*^9, 
   3.628340803019993*^9}, {3.6284025312135057`*^9, 3.62840253544812*^9}, {
   3.628577307619616*^9, 3.6285773076635427`*^9}, {3.628588430982958*^9, 
   3.6285884310022593`*^9}, {3.628591873429985*^9, 3.62859187352887*^9}, {
   3.6285992603127832`*^9, 3.628599260388876*^9}, {3.628599388385674*^9, 
   3.628599388510694*^9}, {3.628601030099334*^9, 3.6286010302791243`*^9}, {
   3.628601132000292*^9, 3.628601171328269*^9}, {3.6286080375696383`*^9, 
   3.628608066732286*^9}, {3.628662961407016*^9, 3.628662961460369*^9}, {
   3.628663387019271*^9, 3.6286633870816107`*^9}, {3.628867505077745*^9, 
   3.628867505146595*^9}, {3.628869028620337*^9, 3.628869028705409*^9}, {
   3.6288690697765617`*^9, 3.6288690701819696`*^9}, {3.6288692029292183`*^9, 
   3.628869203013651*^9}, {3.629474728633608*^9, 3.629474728726275*^9}, 
   3.6294749130715237`*^9, {3.629475033740302*^9, 3.629475041361486*^9}, {
   3.6294764610606737`*^9, 3.62947647803582*^9}, {3.629477312933226*^9, 
   3.629477315815524*^9}, {3.629479500860099*^9, 3.62947950201821*^9}, {
   3.629479591824985*^9, 3.62947959253564*^9}, {3.629538083956606*^9, 
   3.629538086386307*^9}, {3.629542784993021*^9, 3.629542787390736*^9}, {
   3.629543335956024*^9, 3.629543339450059*^9}, 3.629712477075802*^9, 
   3.630686701603119*^9, {3.6314342701408863`*^9, 3.6314343427269783`*^9}, {
   3.631435137673229*^9, 3.631435199293413*^9}, {3.631435250279448*^9, 
   3.6314353212957363`*^9}, {3.631435360337069*^9, 3.631435386103376*^9}, {
   3.631435475345195*^9, 3.631435476014612*^9}, {3.63143556771596*^9, 
   3.631435610839591*^9}, {3.6314356771716013`*^9, 3.631435712338155*^9}, {
   3.6314357853596973`*^9, 3.6314358447303658`*^9}, 3.6314359174753637`*^9, 
   3.631436107320529*^9, {3.631436242764503*^9, 3.631436242947804*^9}, 
   3.63144171355129*^9, 3.6314421025274*^9, 3.631442143912796*^9, {
   3.6314456648392677`*^9, 3.631445667124978*^9}, {3.631446842923579*^9, 
   3.631446885344572*^9}, {3.6342200164741163`*^9, 3.6342200165373373`*^9}, {
   3.653367621400489*^9, 3.653367671295904*^9}, {3.6661901186187572`*^9, 
   3.66619021009873*^9}, {3.6661903153410063`*^9, 3.6661903154282417`*^9}, {
   3.6661904674811172`*^9, 3.6661904799118032`*^9}, {3.6661964266458282`*^9, 
   3.666196430116675*^9}, {3.666196481013842*^9, 3.6661964849674*^9}, {
   3.666196545241837*^9, 3.6661965506836987`*^9}, {3.666197226200036*^9, 
   3.6661972301298018`*^9}, {3.666198727977586*^9, 3.666198728471497*^9}, {
   3.666198833502235*^9, 3.6661988727918463`*^9}, {3.666198933989056*^9, 
   3.666198981960185*^9}, {3.666199021266452*^9, 3.666199062782353*^9}, {
   3.666245228588208*^9, 3.666245372194315*^9}, {3.666958060630023*^9, 
   3.666958060725371*^9}, {3.6670223404237003`*^9, 3.667022531762134*^9}, {
   3.6670227524315557`*^9, 3.667022753932173*^9}, {3.6670227870501127`*^9, 
   3.667022812208084*^9}, {3.667024072445602*^9, 3.667024073849613*^9}, {
   3.66703100452839*^9, 3.667031005986129*^9}, {3.6855327100827303`*^9, 
   3.6855327322611628`*^9}, {3.772854988315995*^9, 3.77285500001752*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"09bab2ae-e32b-4534-b228-96d1e1ff7508"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"bath2sites", "[", 
   RowBox[{"[", "1", "]"}], "]"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "first", " ", "bath", " ", "connects", " ", "to", " ", "sites", " ", "1", 
    " ", "in", " ", "MM", " ", "counting"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bath2sites", "[", 
   RowBox[{"[", "2", "]"}], "]"}], " ", 
  RowBox[{"(*", 
   RowBox[{" ", 
    RowBox[{
    "second", " ", "bath", " ", "connects", " ", "to", " ", "sites", " ", "2",
      " ", "in", " ", "MM", " ", "counting"}], ")"}], " ", "*)"}]}]}], "Input",\

 CellChangeTimes->{{3.6662452610624313`*^9, 3.6662452620514812`*^9}, {
   3.666245384833959*^9, 3.666245463645302*^9}, {3.667022843894393*^9, 
   3.6670228848616657`*^9}, {3.685532755254842*^9, 3.6855327735397787`*^9}, 
   3.772855037497843*^9},
 CellLabel->"In[25]:=",ExpressionUUID->"c1acfe0a-5f1c-40cd-aed9-0ab85295b837"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Initialize each bath", "Subsection",
 CellChangeTimes->{{3.628608267642597*^9, 3.628608282992517*^9}, {
  3.631434369603896*^9, 
  3.631434374827448*^9}},ExpressionUUID->"3f95a7e2-ce47-4e50-9fa0-\
e09c62b4aa2f"],

Cell["No shift \[CapitalOmega] for the moment...", "Text",
 CellChangeTimes->{{3.666190278077581*^9, 3.6661902916533813`*^9}, 
   3.7728554603198643`*^9},ExpressionUUID->"d290c44c-76ff-44a7-9e40-\
d5d1b5362142"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Nu]NUMBATHS", "[", 
    RowBox[{"\[Nu]_", ",", "\[CapitalOmega]_"}], "]"}], "=", 
   RowBox[{"Table", "[", 
    RowBox[{"\[Nu]", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "NUMBATHS"}], "}"}]}], "]"}]}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]NUMBATHS", "[", "\[Lambda]_", "]"}], "=", 
  RowBox[{"Table", "[", 
   RowBox[{"\[Lambda]", ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "NUMBATHS"}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.628601693121915*^9, 3.628601778893401*^9}, {
   3.628603193542877*^9, 3.628603213866775*^9}, {3.628603478837615*^9, 
   3.628603484203101*^9}, {3.628605376856896*^9, 3.62860537695787*^9}, {
   3.628605501303321*^9, 3.628605504379942*^9}, {3.628608289872945*^9, 
   3.628608455271192*^9}, {3.6286085901452293`*^9, 3.628608626601615*^9}, {
   3.628663219479941*^9, 3.6286632507047*^9}, 3.628673408213402*^9, {
   3.628869246530126*^9, 3.628869283267374*^9}, {3.6314344564101954`*^9, 
   3.6314346185517883`*^9}, {3.66619025872103*^9, 3.666190263222582*^9}, {
   3.66624561967817*^9, 3.666245622701754*^9}, {3.6662456785053997`*^9, 
   3.666245678513583*^9}, {3.6665077119129972`*^9, 3.666507712365679*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"917abcdd-fb66-4abf-a759-5a4d08abb09d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
HEOM: construction of auxiliary density operators (ADO) and indexing setup\
\>", "Section",
 CellChangeTimes->{{3.634547019323637*^9, 3.634547022890378*^9}, {
  3.634555963253792*^9, 3.6345559645317717`*^9}, {3.7728551021724033`*^9, 
  3.772855119331644*^9}},ExpressionUUID->"0a17baf7-3afa-40d1-a57b-\
c0bdcfae807e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ADOWIDTH", "=", 
   RowBox[{"NUMBATHS", "*", "MATSUBARAS"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ADOTuple", "=."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ADOTuple", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"nd", "=", "0"}], ",", 
    RowBox[{"nd", "\[LessEqual]", "NMAX"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"iplist", "=", 
      RowBox[{"IntegerPartitions", "[", 
       RowBox[{"nd", ",", "ADOWIDTH"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "iplist", "]"}]}], ",", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"ADOTuple", ",", 
          RowBox[{"Permutations", "[", 
           RowBox[{"PadRight", "[", 
            RowBox[{
             RowBox[{"iplist", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "ADOWIDTH"}], "]"}], 
           "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"i", "++"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"nd", "++"}]}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ADOTuple", "=", 
   RowBox[{"Partition", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", "ADOTuple", "]"}], ",", "ADOWIDTH"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.634547038507642*^9, 3.634547070094962*^9}, {
   3.634547105560508*^9, 3.6345471814673777`*^9}, {3.634547516223037*^9, 
   3.634547545329232*^9}, {3.634548738174262*^9, 3.634548738285275*^9}, {
   3.6345503234888067`*^9, 3.634550353412877*^9}, 3.6345504269856052`*^9, 
   3.634551130322085*^9, 3.634551282897523*^9, 3.634551712869481*^9, 
   3.6345545835336847`*^9, 3.6345578692487707`*^9, 3.634629909705763*^9, 
   3.634640303496582*^9, 3.635062505687821*^9, {3.635611479681697*^9, 
   3.635611479889284*^9}, {3.635687905338279*^9, 3.635687905954071*^9}, {
   3.6357433002364902`*^9, 3.6357433032778873`*^9}, {3.635743505050741*^9, 
   3.635743505146652*^9}, 3.635743633687726*^9, 3.6357438217394342`*^9, 
   3.635743938191371*^9, 3.635744415821706*^9, 3.63574475955905*^9, {
   3.6357450601498127`*^9, 3.635745060285323*^9}, 3.635756975134807*^9, 
   3.635757174258092*^9, {3.6358581252432756`*^9, 3.6358581267704573`*^9}, {
   3.6358633095018463`*^9, 3.635863309584817*^9}, {3.635961915991564*^9, 
   3.6359619160857573`*^9}, {3.6359619601737137`*^9, 
   3.6359619614994297`*^9}, {3.635965607936839*^9, 3.635965608085864*^9}, {
   3.635966162182328*^9, 3.6359661622743607`*^9}, {3.636278033189962*^9, 
   3.63627803328925*^9}, 3.6362903963600693`*^9, 3.636292424154036*^9, 
   3.636293270176031*^9, 3.63629462569308*^9, 3.636295454190392*^9, {
   3.636349443063534*^9, 3.636349444373109*^9}, 3.636349810660634*^9, {
   3.666937448089676*^9, 3.6669374596196527`*^9}, {3.666937661057281*^9, 
   3.666937703904826*^9}, 3.666962197428845*^9, {3.6670197609222*^9, 
   3.66701976096837*^9}, {3.667024115952612*^9, 3.667024116912068*^9}, 
   3.772855126517192*^9, {3.7728553728624*^9, 3.7728553770516357`*^9}, 
   3.7728556315715017`*^9},
 CellLabel->"In[29]:=",ExpressionUUID->"a9e08290-df2b-4d34-8cb0-29a11e12976c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ADOTupleDict", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"FromCharacterCode", "[", 
      RowBox[{"ADOTuple", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "ADOTuple", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"assoc", "=", 
   RowBox[{"Association", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ADOTupleDict", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", "i"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "ADOTuple", "]"}]}], "}"}]}], "]"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.628177727523601*^9, 3.62817777438449*^9}, {
   3.628177874344906*^9, 3.628177923441524*^9}, {3.628177956864214*^9, 
   3.628178017423341*^9}, {3.628178062903314*^9, 3.628178067131462*^9}, {
   3.628178250645166*^9, 3.6281783637935534`*^9}, {3.628178626224036*^9, 
   3.62817870456605*^9}, {3.628178838987512*^9, 3.6281788572485943`*^9}, {
   3.62817895068653*^9, 3.628178988196885*^9}, {3.628179719466858*^9, 
   3.6281797245847063`*^9}, 3.62817985228762*^9, {3.628179886170539*^9, 
   3.628179931657769*^9}, 3.628180006981616*^9, {3.628180409385878*^9, 
   3.628180412825677*^9}, {3.6281826775108957`*^9, 3.628182691245393*^9}, {
   3.6281827669015923`*^9, 3.628182767171659*^9}, {3.62818322101607*^9, 
   3.6281832383894567`*^9}, {3.6281832825986557`*^9, 3.628183285617687*^9}, {
   3.628262310163599*^9, 3.628262311672563*^9}, {3.628262366515423*^9, 
   3.6282623717945347`*^9}, {3.628262439438076*^9, 3.62826243944363*^9}, {
   3.631170283840355*^9, 3.63117028810256*^9}, {3.634547370283805*^9, 
   3.6345473784750633`*^9}, 3.772855169960253*^9, {3.7728553779799137`*^9, 
   3.772855379387724*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"3a9707a8-d6a8-4ecb-9179-107402ae7397"],

Cell["\<\
To implement the PLUS/MINUS actions on index tuples, we define the DD \
possibilities to add/subtract 1 from the tuple elements.\
\>", "Text",
 CellChangeTimes->{{3.631170344882262*^9, 
  3.631170402885998*^9}},ExpressionUUID->"ede1dc63-9b6d-4734-9dbf-\
c38382bfa0dc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"null", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "ADOWIDTH"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"poperator", "=", 
   RowBox[{"Permutations", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"i", "\[Equal]", "1"}], ",", "1", ",", "0"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "ADOWIDTH"}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"moperator", "=", 
   RowBox[{"Permutations", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"i", "\[Equal]", "1"}], ",", 
        RowBox[{"-", "1"}], ",", "0"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "ADOWIDTH"}], "}"}]}], "]"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.634547383001628*^9, 3.634547387434613*^9}, {
   3.6669377120393553`*^9, 3.666937714632062*^9}, 3.666937768886406*^9},
 CellLabel->"In[36]:=",ExpressionUUID->"90c18d38-569b-4f12-baeb-3644809c0442"],

Cell["\<\
For each tuple we now perform the PLUS operation and look up in the \
association map to which uid the PLUS operator leads.
Note that only index tuples with a depth < NMAX do have a PLUS link. \
Non-existing links are pointing to uid=-1.\
\>", "Text",
 CellChangeTimes->{{3.631170411942824*^9, 3.63117044167483*^9}, {
  3.631170492622684*^9, 3.631170583077341*^9}, {3.6311706570824223`*^9, 
  3.631170658592369*^9}, {3.772855196304734*^9, 
  3.772855199088558*^9}},ExpressionUUID->"d980a6d1-022c-44fd-a094-\
aff7bae9f427"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PlusIndex", "=."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PlusIndex", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"-", "1"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"ADOWIDTH", "*", 
        RowBox[{"Length", "[", "ADOTuple", "]"}]}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"uid", "=", "0"}], ",", 
    RowBox[{"uid", "<", 
     RowBox[{"Length", "[", "ADOTuple", "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"j", "=", "0"}], ",", 
       RowBox[{"j", "<", "ADOWIDTH"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tc", "=", 
         RowBox[{"FromCharacterCode", "[", 
          RowBox[{
           RowBox[{"ADOTuple", "[", 
            RowBox[{"[", 
             RowBox[{"uid", "+", "1"}], "]"}], "]"}], "+", 
           RowBox[{"poperator", "[", 
            RowBox[{"[", 
             RowBox[{"j", "+", "1"}], "]"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"PlusIndex", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"ADOWIDTH", "*", "uid"}], "+", "j", "+", "1"}], "]"}], 
          "]"}], "=", 
         RowBox[{"Lookup", "[", 
          RowBox[{"assoc", ",", "tc", ",", 
           RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"j", "++"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"uid", "++"}]}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PlusIndex", "=", 
   RowBox[{"Partition", "[", 
    RowBox[{"PlusIndex", ",", "ADOWIDTH"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.628179013878685*^9, 3.628179016776576*^9}, {
   3.628179048698289*^9, 3.62817911102085*^9}, {3.628179142366007*^9, 
   3.628179162092098*^9}, {3.628179196646101*^9, 3.6281792196530123`*^9}, {
   3.628179258038971*^9, 3.628179262414732*^9}, {3.628179392301317*^9, 
   3.628179416616618*^9}, {3.628179484118032*^9, 3.628179496923254*^9}, {
   3.6281805688039703`*^9, 3.628180938385784*^9}, {3.6281809998911743`*^9, 
   3.628181017976932*^9}, {3.628181071380026*^9, 3.6281810862206507`*^9}, {
   3.628181171283164*^9, 3.628181208903195*^9}, {3.628181305756095*^9, 
   3.6281813111928368`*^9}, {3.628181373688901*^9, 3.628181417963087*^9}, {
   3.6281815063365097`*^9, 3.6281815086355543`*^9}, {3.62818178522959*^9, 
   3.628181786370222*^9}, {3.628182117321402*^9, 3.62818213304928*^9}, {
   3.62818329448825*^9, 3.6281833351055737`*^9}, {3.628252509073257*^9, 
   3.628252509136477*^9}, {3.6282623717996063`*^9, 3.628262371809461*^9}, {
   3.63454739045103*^9, 3.634547433095578*^9}, {3.666937720288477*^9, 
   3.6669377403599854`*^9}, 3.666937772590612*^9, 3.772855190579207*^9, {
   3.772855380259522*^9, 3.772855384195539*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"ea0657d7-2e1f-4a2f-9c77-d30826f0f7e1"],

Cell["\<\
For each tuple we now perform the MINUS operation and look up in the \
association map to which uid the MINUS operator leads.
Note that only tuple elements >=1 do have a MINUS link. Non-existing links \
are pointing to uid=-1.\
\>", "Text",
 CellChangeTimes->{{3.631170411942824*^9, 3.63117044167483*^9}, {
  3.631170492622684*^9, 3.6311706523036423`*^9}, {3.772855203552153*^9, 
  3.772855206872183*^9}},ExpressionUUID->"a2805536-88a4-4f1d-b500-\
f8ec8a798c6d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MinusIndex", "=."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MinusIndex", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"-", "1"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"ADOWIDTH", "*", 
        RowBox[{"Length", "[", "ADOTuple", "]"}]}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"uid", "=", "0"}], ",", 
    RowBox[{"uid", "<", 
     RowBox[{"Length", "[", "ADOTuple", "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"j", "=", "0"}], ",", 
       RowBox[{"j", "<", "ADOWIDTH"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"testADOTuple", "=", 
         RowBox[{
          RowBox[{"ADOTuple", "[", 
           RowBox[{"[", 
            RowBox[{"uid", "+", "1"}], "]"}], "]"}], "+", 
          RowBox[{"moperator", "[", 
           RowBox[{"[", 
            RowBox[{"j", "+", "1"}], "]"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"testADOTuple", ",", 
            RowBox[{"-", "1"}]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"MinusIndex", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"ADOWIDTH", "*", "uid"}], "+", "j", "+", "1"}], "]"}], 
             "]"}], "=", 
            RowBox[{"-", "1"}]}], ";"}], "\[IndentingNewLine]", ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"tc", "=", 
            RowBox[{"FromCharacterCode", "[", "testADOTuple", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"MinusIndex", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"ADOWIDTH", "*", "uid"}], "+", "j", "+", "1"}], "]"}], 
             "]"}], "=", 
            RowBox[{"Lookup", "[", 
             RowBox[{"assoc", ",", "tc", ",", 
              RowBox[{"-", "1"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"j", "++"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"uid", "++"}]}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MinusIndex", "=", 
   RowBox[{"Partition", "[", 
    RowBox[{"MinusIndex", ",", "ADOWIDTH"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6281815723052673`*^9, 3.628181584374967*^9}, {
   3.628181790461063*^9, 3.628181797353503*^9}, {3.628181995393958*^9, 
   3.6281820267441273`*^9}, {3.628182114513344*^9, 3.628182137713044*^9}, {
   3.628183342521142*^9, 3.628183353621257*^9}, {3.6281834368882523`*^9, 
   3.62818343847604*^9}, {3.6281834903801003`*^9, 3.628183490505561*^9}, {
   3.628183530579895*^9, 3.628183578160795*^9}, {3.628183652528118*^9, 
   3.6281837324979763`*^9}, {3.6282524999143972`*^9, 3.628252505641116*^9}, {
   3.62826237181444*^9, 3.628262371824636*^9}, {3.62826240807051*^9, 
   3.628262408075952*^9}, {3.634547409050199*^9, 3.634547459821567*^9}, {
   3.634547493238989*^9, 3.6345474998368587`*^9}, {3.666937725902938*^9, 
   3.666937737624185*^9}, 3.666937781876903*^9, 3.772855187227606*^9, {
   3.7728553888431683`*^9, 3.7728553921712637`*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"4806304e-7e32-4eb9-98bf-a25a068bd67d"],

Cell[BoxData[
 RowBox[{"Print", "[", 
  RowBox[{"\"\<Total number of ADOs: \>\"", ",", 
   RowBox[{"Length", "[", "ADOTupleDict", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6281810223053417`*^9, 3.6281810570650883`*^9}, {
  3.628181098187965*^9, 3.628181101387792*^9}, {3.628181144818039*^9, 
  3.628181160653528*^9}, {3.6281815199468327`*^9, 3.628181544413392*^9}, {
  3.628181599890327*^9, 3.62818160300815*^9}, {3.62818177501327*^9, 
  3.628181809843398*^9}, {3.62818236578895*^9, 3.628182375820176*^9}, {
  3.6281838637225037`*^9, 3.628183926420128*^9}, {3.628253037575314*^9, 
  3.628253040552554*^9}, {3.628262439427281*^9, 3.6282624394332647`*^9}, {
  3.772855327207169*^9, 3.772855342851049*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"2114e71b-5812-4cba-b31e-11e5df909e98"],

Cell[CellGroupData[{

Cell["Setup of the operators", "Subsection",
 CellChangeTimes->{{3.772855239070949*^9, 
  3.7728552487585697`*^9}},ExpressionUUID->"3de97194-515a-45a7-b83d-\
b94a2aec9b92"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Nu]bk", "[", 
   RowBox[{
   "b_", ",", "k_", ",", "\[HBar]_", ",", "\[Nu]_", ",", "\[Lambda]_", ",", 
    "\[Beta]_", ",", "\[Nu]1_", ",", "\[CapitalOmega]_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"k", "\[Equal]", "0"}], ",", 
    RowBox[{
     RowBox[{"\[Nu]NUMBATHS", "[", 
      RowBox[{"\[Nu]", ",", "\[CapitalOmega]"}], "]"}], "[", 
     RowBox[{"[", "b", "]"}], "]"}], ",", 
    RowBox[{"2", "\[Pi]", " ", 
     RowBox[{"k", "/", 
      RowBox[{"(", 
       RowBox[{"\[Beta]", " ", "\[HBar]"}], ")"}]}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.634544340481118*^9, 3.6345443910146627`*^9}, {
   3.634544494483918*^9, 3.634544494809493*^9}, {3.6345460244804573`*^9, 
   3.634546024533177*^9}, {3.634546846288094*^9, 3.634546858026691*^9}, {
   3.6345478290998583`*^9, 3.6345478413495073`*^9}, {3.666937876084655*^9, 
   3.666937891251178*^9}, 3.6669379435144987`*^9},
 CellLabel->"In[48]:=",ExpressionUUID->"acb4c032-4d82-4034-9e61-e39d391950dd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"cbk", "[", 
   RowBox[{
   "b_", ",", "k_", ",", "\[HBar]_", ",", "\[Nu]_", ",", "\[Lambda]_", ",", 
    "\[Beta]_", ",", "\[Nu]1_", ",", "\[CapitalOmega]_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"k", "\[Equal]", "0"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Nu]NUMBATHS", "[", 
       RowBox[{"\[Nu]", ",", "\[CapitalOmega]"}], "]"}], "[", 
      RowBox[{"[", "b", "]"}], "]"}], 
     RowBox[{
      RowBox[{"\[Lambda]NUMBATHS", "[", "\[Lambda]", "]"}], "[", 
      RowBox[{"[", "b", "]"}], "]"}], 
     RowBox[{"Cot", "[", 
      RowBox[{"\[Beta]", " ", "\[HBar]", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Nu]NUMBATHS", "[", 
          RowBox[{"\[Nu]", ",", "\[CapitalOmega]"}], "]"}], "[", 
         RowBox[{"[", "b", "]"}], "]"}], "/", "2"}]}], "]"}]}], ",", 
    RowBox[{
     FractionBox[
      RowBox[{"4", 
       RowBox[{
        RowBox[{"\[Lambda]NUMBATHS", "[", "\[Lambda]", "]"}], "[", 
        RowBox[{"[", "b", "]"}], "]"}], 
       RowBox[{
        RowBox[{"\[Nu]NUMBATHS", "[", 
         RowBox[{"\[Nu]", ",", "\[CapitalOmega]"}], "]"}], "[", 
        RowBox[{"[", "b", "]"}], "]"}]}], 
      RowBox[{"\[Beta]", " ", "\[HBar]"}]], 
     FractionBox[
      RowBox[{"(", 
       RowBox[{"2", "\[Pi]", " ", 
        RowBox[{"k", "/", 
         RowBox[{"(", 
          RowBox[{"\[Beta]", " ", "\[HBar]"}], ")"}]}]}], ")"}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"2", "\[Pi]", " ", 
          RowBox[{"k", "/", 
           RowBox[{"(", 
            RowBox[{"\[Beta]", " ", "\[HBar]"}], ")"}]}]}], ")"}], "2"], "-", 
       
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Nu]NUMBATHS", "[", 
           RowBox[{"\[Nu]", ",", "\[CapitalOmega]"}], "]"}], "[", 
          RowBox[{"[", "b", "]"}], "]"}], ")"}], "2"]}]]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.634544109655298*^9, 3.6345441528344173`*^9}, {
   3.6345441954257298`*^9, 3.634544335628879*^9}, {3.634544370274325*^9, 
   3.634544370560109*^9}, {3.634544407475174*^9, 3.634544452915738*^9}, {
   3.634546026832685*^9, 3.634546026893794*^9}, {3.6345468486241493`*^9, 
   3.6345468739553967`*^9}, {3.634547612240387*^9, 3.634547618779871*^9}, {
   3.634547844818688*^9, 3.634547845148547*^9}, {3.63455020113454*^9, 
   3.6345502027847157`*^9}, 3.634550272290247*^9, {3.635863586581285*^9, 
   3.635863586859906*^9}, {3.635959790462511*^9, 3.635959798237163*^9}, {
   3.666937943519884*^9, 3.6669379435319777`*^9}, {3.666937977323559*^9, 
   3.6669379773279257`*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"1fd51d16-7f12-4950-b548-e36ab97d21a8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"bktt", "[", 
   RowBox[{"b_", ",", "k_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"b", "-", "1"}], ")"}], "*", "MATSUBARAS"}], "+", "k", "+", 
   "1"}]}]], "Input",
 CellChangeTimes->{{3.6345486393952227`*^9, 3.634548704848199*^9}, {
   3.634548768388487*^9, 3.6345487920428877`*^9}, 3.6345510765143223`*^9, 
   3.6345511926440563`*^9, {3.634551235953596*^9, 3.63455124335233*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"b7b91fa9-e983-4b6a-a7a0-8e72c31ed7d8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"kkOp", "[", "k_", "]"}], ":=", 
  RowBox[{"DiagonalMatrix", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"i", "\[Equal]", "k"}], ",", "1", ",", "0"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "SITES"}], "}"}]}], "]"}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.6669384464091578`*^9, 3.6669384479729843`*^9}},
 CellLabel->"In[51]:=",ExpressionUUID->"b5690dd0-2a87-4650-a2ca-91c59ac92e4e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Phi]k", "[", 
   RowBox[{"k_", ",", "A_"}], "]"}], ":=", 
  RowBox[{"\[ImaginaryI]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"kkOp", "[", "k", "]"}], ".", "A"}], "-", 
     RowBox[{"A", ".", 
      RowBox[{"kkOp", "[", "k", "]"}]}]}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Vcross", "[", 
   RowBox[{"k_", ",", "A_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"kkOp", "[", "k", "]"}], ".", "A"}], "-", 
   RowBox[{"A", ".", 
    RowBox[{"kkOp", "[", "k", "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Vcirc", "[", 
   RowBox[{"k_", ",", "A_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"kkOp", "[", "k", "]"}], ".", "A"}], "+", 
   RowBox[{"A", ".", 
    RowBox[{"kkOp", "[", "k", "]"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.6669385011035833`*^9, 3.666938501495152*^9}},
 CellLabel->"In[52]:=",ExpressionUUID->"3d615338-a13f-4e8c-b2fc-93a8d980772d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Theta]kMA", "[", 
   RowBox[{
   "b_", ",", "s_", ",", "k_", ",", "A_", ",", "\[HBar]_", ",", "\[Nu]_", ",",
     "\[Lambda]_", ",", "\[Beta]_", ",", "\[Nu]1_", ",", "\[CapitalOmega]_"}],
    "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"k", "\[Equal]", "0"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "\[Lambda]", " ", "\[Nu]", " ", 
         RowBox[{"Cot", "[", 
          FractionBox[
           RowBox[{"\[Beta]", " ", "\[Nu]", " ", "\[HBar]"}], "2"], "]"}]}], 
        "\[HBar]"], ")"}], 
      RowBox[{"Vcross", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"bath2sites", "[", 
          RowBox[{"[", "b", "]"}], "]"}], "[", 
         RowBox[{"[", "s", "]"}], "]"}], ",", "A"}], "]"}]}], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"Vcirc", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"bath2sites", "[", 
           RowBox[{"[", "b", "]"}], "]"}], "[", 
          RowBox[{"[", "s", "]"}], "]"}], ",", "A"}], "]"}], " ", "\[Nu]", 
       " ", "\[Lambda]"}], "\[HBar]"]}], "   ", ",", 
    RowBox[{
     FractionBox[
      RowBox[{"4", " ", "\[ImaginaryI]", " ", "\[Nu]", " ", "\[Lambda]", "  ", 
       RowBox[{"\[Nu]bk", "[", 
        RowBox[{
        "b", ",", "k", ",", "\[HBar]", ",", "\[Nu]", ",", "\[Lambda]", ",", 
         "\[Beta]", ",", "\[Nu]1", ",", "\[CapitalOmega]"}], "]"}]}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[Beta]"}], " ", 
         SuperscriptBox["\[Nu]", "2"], " ", 
         SuperscriptBox["\[HBar]", "2"]}], "+", 
        RowBox[{"\[Beta]", " ", 
         SuperscriptBox["\[HBar]", "2"], " ", 
         SuperscriptBox[
          RowBox[{"\[Nu]bk", "[", 
           RowBox[{
           "b", ",", "k", ",", "\[HBar]", ",", "\[Nu]", ",", "\[Lambda]", ",",
             "\[Beta]", ",", "\[Nu]1", ",", "\[CapitalOmega]"}], "]"}], 
          "2"]}]}], ")"}]], 
     RowBox[{"Vcross", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"bath2sites", "[", 
         RowBox[{"[", "b", "]"}], "]"}], "[", 
        RowBox[{"[", "s", "]"}], "]"}], ",", "A"}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.666938480519212*^9, 3.666938481775179*^9}, {
  3.6669385190727367`*^9, 3.666938527056409*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"0a15e4ea-538c-4260-b9b0-f0419bdc7009"]
}, Open  ]],

Cell[CellGroupData[{

Cell["The final HEOM equation (in similar notation to [R3]) ", "Subsection",
 CellChangeTimes->{{3.772855266693981*^9, 3.772855274133556*^9}, {
  3.7728710367802343`*^9, 
  3.77287106212983*^9}},ExpressionUUID->"610a3bda-950d-4fab-80fc-\
db94fd9de434"],

Cell[BoxData[
 RowBox[{
  RowBox[{"d\[Sigma]dtMASC", "[", 
   RowBox[{
   "HM_", ",", "\[Sigma]M_", ",", "uid_", ",", "\[HBar]_", ",", "\[Nu]_", ",",
     "\[Lambda]_", ",", "\[Beta]_", ",", "\[Nu]1_", ",", "\[CapitalOmega]_"}],
    "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox["\[ImaginaryI]", "\[HBar]"]}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"HM", ".", 
        RowBox[{"\[Sigma]M", "[", 
         RowBox[{"[", "uid", "]"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"\[Sigma]M", "[", 
         RowBox[{"[", "uid", "]"}], "]"}], ".", "HM"}]}], ")"}]}], "-", 
    RowBox[{
     RowBox[{"\[Sigma]M", "[", 
      RowBox[{"[", "uid", "]"}], "]"}], 
     RowBox[{
      UnderoverscriptBox["\[Sum]", 
       RowBox[{"b", "=", "1"}], "NUMBATHS"], 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"k", "=", "0"}], 
        RowBox[{"MATSUBARAS", "-", "1"}]], " ", 
       RowBox[{
        RowBox[{
         RowBox[{"ADOTuple", "[", 
          RowBox[{"[", "uid", "]"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"bktt", "[", 
           RowBox[{"b", ",", "k"}], "]"}], "]"}], "]"}], 
        RowBox[{"\[Nu]bk", "[", 
         RowBox[{
         "b", ",", "k", ",", "\[HBar]", ",", "\[Nu]", ",", "\[Lambda]", ",", 
          "\[Beta]", ",", "\[Nu]1", ",", "\[CapitalOmega]"}], "]"}]}]}]}]}], 
    "-", " ", 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"b", "=", "1"}], "NUMBATHS"], 
     RowBox[{
      UnderoverscriptBox["\[Sum]", 
       RowBox[{"s", "=", "1"}], 
       RowBox[{"Length", "[", 
        RowBox[{"bath2sites", "[", 
         RowBox[{"[", "b", "]"}], "]"}], "]"}]], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"2", 
           RowBox[{
            RowBox[{"\[Lambda]NUMBATHS", "[", "\[Lambda]", "]"}], "[", 
            RowBox[{"[", "b", "]"}], "]"}]}], 
          RowBox[{"\[Beta]", " ", 
           SuperscriptBox["\[HBar]", "2"], 
           RowBox[{
            RowBox[{"\[Nu]NUMBATHS", "[", 
             RowBox[{"\[Nu]", ",", "\[CapitalOmega]"}], "]"}], "[", 
            RowBox[{"[", "b", "]"}], "]"}]}]], "-", 
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"k", "=", "0"}], 
           RowBox[{"MATSUBARAS", "-", "1"}]], 
          FractionBox[
           RowBox[{"cbk", "[", 
            RowBox[{
            "b", ",", "k", ",", "\[HBar]", ",", "\[Nu]", ",", "\[Lambda]", 
             ",", "\[Beta]", ",", "\[Nu]1", ",", "\[CapitalOmega]"}], "]"}], 
           RowBox[{"\[HBar]", " ", 
            RowBox[{"\[Nu]bk", "[", 
             RowBox[{
             "b", ",", "k", ",", "\[HBar]", ",", "\[Nu]", ",", "\[Lambda]", 
              ",", "\[Beta]", ",", "\[Nu]1", ",", "\[CapitalOmega]"}], 
             "]"}]}]]}]}], ")"}], " ", 
       RowBox[{"Vcross", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"bath2sites", "[", 
           RowBox[{"[", "b", "]"}], "]"}], "[", 
          RowBox[{"[", "s", "]"}], "]"}], ",", 
         RowBox[{"Vcross", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"bath2sites", "[", 
             RowBox[{"[", "b", "]"}], "]"}], "[", 
            RowBox[{"[", "s", "]"}], "]"}], ",", 
           RowBox[{"\[Sigma]M", "[", 
            RowBox[{"[", "uid", "]"}], "]"}]}], " ", "]"}]}], "]"}]}]}]}], 
    "+", 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"b", "=", "1"}], "NUMBATHS"], 
     RowBox[{
      UnderoverscriptBox["\[Sum]", 
       RowBox[{"s", "=", "1"}], 
       RowBox[{"Length", "[", 
        RowBox[{"bath2sites", "[", 
         RowBox[{"[", "b", "]"}], "]"}], "]"}]], 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"k", "=", "0"}], 
        RowBox[{"MATSUBARAS", "-", "1"}]], 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"ADOTuple", "[", 
              RowBox[{"[", "uid", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"bktt", "[", 
               RowBox[{"b", ",", "k"}], "]"}], "]"}], "]"}], "+", "1"}], 
           ")"}], 
          RowBox[{"Abs", "[", 
           RowBox[{
            RowBox[{"cbk", "[", 
             RowBox[{
             "b", ",", "k", ",", "\[HBar]", ",", "\[Nu]", ",", "\[Lambda]", 
              ",", "\[Beta]", ",", "\[Nu]1", ",", "\[CapitalOmega]"}], "]"}], 
            "/", "\[HBar]"}], "]"}]}], "]"}], 
        RowBox[{"\[Phi]k", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"bath2sites", "[", 
            RowBox[{"[", "b", "]"}], "]"}], "[", 
           RowBox[{"[", "s", "]"}], "]"}], ",", 
          RowBox[{"\[Sigma]M", "[", 
           RowBox[{"[", " ", 
            RowBox[{
             RowBox[{"PlusIndex", "[", 
              RowBox[{"[", "uid", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"bktt", "[", 
               RowBox[{"b", ",", "k"}], "]"}], "]"}], "]"}], " ", "]"}], 
           "]"}]}], " ", "]"}]}]}]}]}], "\[IndentingNewLine]", "+", 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"b", "=", "1"}], "NUMBATHS"], 
     RowBox[{
      UnderoverscriptBox["\[Sum]", 
       RowBox[{"s", "=", "1"}], 
       RowBox[{"Length", "[", 
        RowBox[{"bath2sites", "[", 
         RowBox[{"[", "b", "]"}], "]"}], "]"}]], 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"k", "=", "0"}], 
        RowBox[{"MATSUBARAS", "-", "1"}]], 
       RowBox[{
        RowBox[{"Sqrt", "[", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"ADOTuple", "[", 
            RowBox[{"[", "uid", "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"bktt", "[", 
             RowBox[{"b", ",", "k"}], "]"}], "]"}], "]"}], "/", 
          RowBox[{"Abs", "[", 
           RowBox[{
            RowBox[{"cbk", "[", 
             RowBox[{
             "b", ",", "k", ",", "\[HBar]", ",", "\[Nu]", ",", "\[Lambda]", 
              ",", "\[Beta]", ",", "\[Nu]1", ",", "\[CapitalOmega]"}], "]"}], 
            "/", "\[HBar]"}], "]"}]}], "]"}], " ", 
        RowBox[{"\[Theta]kMA", "[", 
         RowBox[{"b", ",", "s", ",", "k", ",", 
          RowBox[{"\[Sigma]M", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"MinusIndex", "[", 
              RowBox[{"[", "uid", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"bktt", "[", 
               RowBox[{"b", ",", "k"}], "]"}], "]"}], "]"}], "]"}], "]"}], 
          ",", "\[HBar]", ",", 
          RowBox[{
           RowBox[{"\[Nu]NUMBATHS", "[", 
            RowBox[{"\[Nu]", ",", "\[CapitalOmega]"}], "]"}], "[", 
           RowBox[{"[", "b", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"\[Lambda]NUMBATHS", "[", "\[Lambda]", "]"}], "[", 
           RowBox[{"[", "b", "]"}], "]"}], ",", "\[Beta]", ",", "\[Nu]1", ",",
           "\[CapitalOmega]"}], "]"}]}]}]}]}]}], ")"}]}]], "Input",
 CellChangeTimes->{{3.66693794353694*^9, 3.666937943541553*^9}, {
   3.666937977333878*^9, 3.66693797733851*^9}, {3.666938173847238*^9, 
   3.666938194764523*^9}, {3.666938269335225*^9, 3.666938307442421*^9}, {
   3.666938340688727*^9, 3.666938352688822*^9}, {3.666938484824862*^9, 
   3.666938486656746*^9}, {3.6669606359753027`*^9, 3.6669606428304873`*^9}, 
   3.6669606928089113`*^9, 3.666960757252084*^9, {3.666961175690177*^9, 
   3.6669611778404617`*^9}, {3.77285539693568*^9, 3.772855399205475*^9}},
 CellLabel->"In[56]:=",ExpressionUUID->"a7a78e0c-d8e6-491a-9656-7556de797ef5"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "\[LineSeparator]Running the HEOM algorithm  within ",
 StyleBox["Mathematica",
  FontSlant->"Italic"]
}], "Section",
 CellChangeTimes->{{3.628251985886447*^9, 3.628251989364862*^9}, {
   3.628262159726013*^9, 3.628262160523316*^9}, 3.6288584838500557`*^9, {
   3.631440471760956*^9, 3.631440479911212*^9}, 3.666192195299913*^9, {
   3.667023931343893*^9, 3.667023936719933*^9}, {3.772855283493371*^9, 
   3.772855286389216*^9}},ExpressionUUID->"a6c6cecc-e5ee-46b6-aea7-\
1dfe7d36a894"],

Cell["\<\
Now use the matrices and include as last element a zero matrix, this ensures \
that whenever \[Sigma]M[-1] is called, it does not contribute, since the \
array index -1 maps to the last element (=the zeroed matrix).\
\>", "Text",
 CellChangeTimes->{{3.6282532798531647`*^9, 3.628253324608399*^9}, {
  3.6311722131459627`*^9, 3.6311722416134663`*^9}, {3.772855303276553*^9, 
  3.772855304076557*^9}},ExpressionUUID->"2001ab71-2a46-4a44-a30b-\
f64ff78f3b56"],

Cell[BoxData[{
 RowBox[{"nM", "=", 
  RowBox[{"DiagonalMatrix", "[", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "SITES"}], "}"}]}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]M0", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"nM", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "ADOTuple", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.628253227551547*^9, 3.62825327254183*^9}, 
   3.628262371840294*^9, {3.6282715987696743`*^9, 3.62827160989634*^9}, {
   3.6284037244508123`*^9, 3.628403769949781*^9}, {3.628406359794182*^9, 
   3.628406365134974*^9}, 3.628411753514687*^9, {3.628601335886321*^9, 
   3.628601368546191*^9}, {3.666938567165339*^9, 3.666938567276565*^9}, 
   3.772855400772047*^9},
 CellLabel->"In[57]:=",ExpressionUUID->"256186e6-68fc-4135-91f3-883a3fd19cec"],

Cell["Set the initial density matrix", "Text",
 CellChangeTimes->{{3.6665022263109093`*^9, 
  3.666502232597488*^9}},ExpressionUUID->"0cafa278-4f29-459c-b3a1-\
785876889930"],

Cell[BoxData[
 RowBox[{"rho0", "=", 
  RowBox[{"DiagonalMatrix", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"i", "\[Equal]", "1"}], ",", "1", ",", "0"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "SITES"}], "}"}]}], "]"}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.63144046067484*^9, 3.631440466600911*^9}, {
  3.666192206813425*^9, 3.666192226444556*^9}, {3.66619881372528*^9, 
  3.666198822861794*^9}, {3.666247311900105*^9, 3.6662473296121893`*^9}, {
  3.685534123342002*^9, 3.685534128706624*^9}},
 CellLabel->"In[59]:=",ExpressionUUID->"479e4a9e-37ca-4b9f-83ec-d20c79ea4013"],

Cell[BoxData[
 RowBox[{"rho0", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.628570961551491*^9, 3.628570965025078*^9}},
 CellLabel->"In[60]:=",ExpressionUUID->"597d9ec5-06e7-4f09-8eba-e3ddfbda108d"],

Cell["\<\
Initialize one member of the hierarchy with the initial density matrix, \
append the zero matrix at the end for the -1 links\
\>", "Text",
 CellChangeTimes->{{3.628253385729554*^9, 3.628253401271365*^9}, {
  3.628271628384748*^9, 3.628271629719103*^9}, {3.6282724329771233`*^9, 
  3.6282724344955597`*^9}, {3.62886748969235*^9, 3.628867491306768*^9}, {
  3.666502236309366*^9, 
  3.666502246604875*^9}},ExpressionUUID->"57117ee9-c8a9-4927-849b-\
80dd2f8ac348"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]M0", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "=", "rho0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"\[Sigma]M0", ",", "nM"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6282520588866167`*^9, 3.628252066268942*^9}, {
   3.6282533573159018`*^9, 3.628253368226884*^9}, {3.628271633576518*^9, 
   3.6282716354874496`*^9}, {3.6284038344300623`*^9, 
   3.6284038395560083`*^9}, {3.62859470361196*^9, 3.628594704061228*^9}, 
   3.6285961045864573`*^9, {3.6286013830428543`*^9, 3.6286013862581377`*^9}, {
   3.628602783152403*^9, 3.628602785924378*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"a2c918e8-21f2-44a6-89f6-97053714f8a0"],

Cell[CellGroupData[{

Cell["Taylor integration", "Subsection",
 CellChangeTimes->{{3.631178493381215*^9, 3.6311785547661552`*^9}, {
  3.693049962842515*^9, 
  3.693049969016316*^9}},ExpressionUUID->"1838855f-a32b-40be-86ee-\
a9b802aa26f2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"m", "=", "200"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"number", " ", "of", " ", "steps"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"YTA4", "=", 
   RowBox[{"T", "=", 
    RowBox[{"Table", "[", 
     RowBox[{"0", ",", 
      RowBox[{"{", 
       RowBox[{"m", "+", "1"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"T", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"YTA4", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "=", "\[Sigma]M0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Timing", "[", "\[IndentingNewLine]", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"j", "=", "1"}], ",", 
    RowBox[{"j", "\[LessEqual]", "m"}], ",", 
    RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"k1", "=", 
      RowBox[{"SetPrecision", "[", 
       RowBox[{
        RowBox[{"hSI", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"d\[Sigma]dtMASC", "[", 
            RowBox[{"HMSI", ",", 
             RowBox[{"YTA4", "[", 
              RowBox[{"[", "j", "]"}], "]"}], ",", "              ", "i", ",",
              "\[HBar]SI", ",", "\[Nu]SI", ",", "\[Lambda]SI", ",", 
             "\[Beta]SI", ",", "\[Nu]1SI", ",", "\[CapitalOmega]SI"}], "]"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "ADOTuple", "]"}]}], "}"}]}], "]"}]}], 
        ",", "PRECISION"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"k1", ",", "nM"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"YTA4", "[", 
       RowBox[{"[", 
        RowBox[{"j", "+", "1"}], "]"}], "]"}], "=", 
      RowBox[{"SetPrecision", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"YTA4", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "+", 
         RowBox[{"k1", "/", 
          RowBox[{"1", "!"}]}]}], ",", "PRECISION"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"k2", "=", 
      RowBox[{"hSI", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"d\[Sigma]dtMASC", "[", 
          RowBox[{
          "HMSI", ",", "k1", ",", "i", ",", "\[HBar]SI", ",", "\[Nu]SI", ",", 
           "\[Lambda]SI", ",", "\[Beta]SI", ",", "\[Nu]1SI", ",", 
           "\[CapitalOmega]SI"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "ADOTuple", "]"}]}], "}"}]}], "]"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"k2", ",", "nM"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"YTA4", "[", 
       RowBox[{"[", 
        RowBox[{"j", "+", "1"}], "]"}], "]"}], "=", 
      RowBox[{"SetPrecision", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"YTA4", "[", 
          RowBox[{"[", 
           RowBox[{"j", "+", "1"}], "]"}], "]"}], "+", 
         RowBox[{"k2", "/", 
          RowBox[{"2", "!"}]}]}], ",", "PRECISION"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"k1", "=", 
      RowBox[{"hSI", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"d\[Sigma]dtMASC", "[", 
          RowBox[{
          "HMSI", ",", "k2", ",", "i", ",", "\[HBar]SI", ",", "\[Nu]SI", ",", 
           "\[Lambda]SI", ",", "\[Beta]SI", ",", "\[Nu]1SI", ",", 
           "\[CapitalOmega]SI"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "ADOTuple", "]"}]}], "}"}]}], "]"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"k1", ",", "nM"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"YTA4", "[", 
       RowBox[{"[", 
        RowBox[{"j", "+", "1"}], "]"}], "]"}], "=", 
      RowBox[{"SetPrecision", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"YTA4", "[", 
          RowBox[{"[", 
           RowBox[{"j", "+", "1"}], "]"}], "]"}], "+", 
         RowBox[{"k1", "/", 
          RowBox[{"3", "!"}]}]}], ",", "PRECISION"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"k2", "=", 
      RowBox[{"hSI", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"d\[Sigma]dtMASC", "[", 
          RowBox[{
          "HMSI", ",", "k1", ",", "i", ",", "\[HBar]SI", ",", "\[Nu]SI", ",", 
           "\[Lambda]SI", ",", "\[Beta]SI", ",", "\[Nu]1SI", ",", 
           "\[CapitalOmega]SI"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "ADOTuple", "]"}]}], "}"}]}], "]"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"k2", ",", "nM"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"YTA4", "[", 
       RowBox[{"[", 
        RowBox[{"j", "+", "1"}], "]"}], "]"}], "=", 
      RowBox[{"SetPrecision", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"YTA4", "[", 
          RowBox[{"[", 
           RowBox[{"j", "+", "1"}], "]"}], "]"}], "+", 
         RowBox[{"k2", "/", 
          RowBox[{"4", "!"}]}]}], ",", "PRECISION"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"T", "[", 
       RowBox[{"[", 
        RowBox[{"j", "+", "1"}], "]"}], "]"}], "=", 
      RowBox[{"hSI", "*", "j"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.693049978257821*^9, 3.693050032335306*^9}, {
  3.693050064079369*^9, 3.6930501405543528`*^9}, {3.693050170835305*^9, 
  3.693050235438697*^9}, {3.693050465093533*^9, 3.693050679003512*^9}, {
  3.693050727446434*^9, 3.693050738107717*^9}, {3.693050828970894*^9, 
  3.693050940849146*^9}, {3.6930509768722963`*^9, 3.6930509817275352`*^9}, {
  3.693051048192284*^9, 3.693051066108127*^9}, {3.772854671202036*^9, 
  3.772854687616619*^9}, {3.772854755199326*^9, 3.772854769035964*^9}, {
  3.7728554065176477`*^9, 3.7728554070682907`*^9}, {3.772871109181404*^9, 
  3.772871113938538*^9}},
 CellLabel->"In[63]:=",ExpressionUUID->"ca3f1a66-16c6-4498-8068-d000e0b0ac5d"],

Cell[BoxData[
 RowBox[{"p", "=", 
  RowBox[{"ListPlot", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"T", "*", 
          RowBox[{"10", "^", "12"}]}], ",", 
         RowBox[{"Re", "[", 
          RowBox[{"YTA4", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1", ",", "1", ",", "1"}], "]"}], "]"}], 
          "]"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"T", "*", 
          RowBox[{"10", "^", "12"}]}], ",", 
         RowBox[{"Re", "[", 
          RowBox[{"YTA4", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1", ",", "2", ",", "2"}], "]"}], "]"}], 
          "]"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"T", "*", 
          RowBox[{"10", "^", "12"}]}], ",", 
         RowBox[{"Re", "[", 
          RowBox[{"YTA4", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1", ",", "1", ",", "2"}], "]"}], "]"}], 
          "]"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"T", "*", 
          RowBox[{"10", "^", "12"}]}], ",", 
         RowBox[{"Im", "[", 
          RowBox[{"YTA4", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1", ",", "1", ",", "2"}], "]"}], "]"}], 
          "]"}]}], "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
    RowBox[{"PlotLabels", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
       "Text", "[", "\"\<\!\(\*SubscriptBox[\(\[Rho]\), \(11\)]\)\>\"", "]"}],
        ",", 
       RowBox[{
       "Text", "[", "\"\<\!\(\*SubscriptBox[\(\[Rho]\), \(22\)]\)\>\"", "]"}],
        ",", 
       RowBox[{
       "Text", "[", "\"\<\!\(\*SubscriptBox[\(Re\[Rho]\), \(12\)]\)\>\"", 
        "]"}], ",", 
       RowBox[{
       "Text", "[", "\"\<\!\(\*SubscriptBox[\(Im\[Rho]\), \(12\)]\)\>\"", 
        "]"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"Joined", "\[Rule]", "True"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "220"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", "1.4"}], ",", 
    RowBox[{"LabelStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", "15"}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0.5", ",", "1.0"}], "}"}], ",", "None"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0.5", ",", "1.0"}], "}"}], ",", "None"}], 
        "}"}]}], "}"}]}], ",", 
    RowBox[{"GridLines", "\[Rule]", "Automatic"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.772871167673006*^9, 3.772871168879115*^9}, {
  3.7728712151760807`*^9, 3.772871316416843*^9}, {3.772871348834095*^9, 
  3.7728713739363813`*^9}, {3.772871463631672*^9, 3.772871502356646*^9}, {
  3.7728715626995993`*^9, 3.772871584824156*^9}, {3.773143613353096*^9, 
  3.7731436390392933`*^9}, {3.773143699533485*^9, 3.7731439144588346`*^9}, {
  3.773144005969264*^9, 3.773144018934515*^9}, {3.773144049231655*^9, 
  3.773144070320158*^9}, {3.773144101525021*^9, 3.77314427333493*^9}, {
  3.773144354989654*^9, 3.773144355595546*^9}, {3.773144496692679*^9, 
  3.773144496840836*^9}},
 CellLabel->"In[68]:=",ExpressionUUID->"661c8f8a-3b4a-4486-9fd1-31b505dfbe15"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Export", "[", 
   RowBox[{"\"\<fig_oqsd.png\>\"", ",", "p", ",", 
    RowBox[{"ImageResolution", "\[Rule]", "200"}]}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.77314435719905*^9, 3.7731443730032988`*^9}, {
  3.773456531202807*^9, 3.77345653400928*^9}},
 CellLabel->"In[69]:=",ExpressionUUID->"84c214c2-09e2-4630-808c-96550b90ac42"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1372, 855},
WindowMargins->{{3, Automatic}, {Automatic, 0}},
PrintingCopies->1,
PrintingPageRange->{1, Automatic},
CellContext->Notebook,
PrintPrecision->3,
FrontEndVersion->"11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, \
2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 525, 10, 160, "Title",ExpressionUUID->"b3386616-d619-4d08-87f8-2dcc43940a47"],
Cell[1108, 34, 1898, 29, 196, "Text",ExpressionUUID->"19543ba8-7302-49e2-ab87-f782ff7641af"],
Cell[CellGroupData[{
Cell[3031, 67, 163, 3, 67, "Section",ExpressionUUID->"acdfa906-649a-4369-8aee-68f2ec0741a4"],
Cell[3197, 72, 507, 14, 73, "Input",ExpressionUUID->"b102d30c-b7e1-4ddb-aebe-ea5bcc17765d"],
Cell[3707, 88, 432, 7, 30, "Input",ExpressionUUID->"60529da6-da5d-4891-b847-a7f324b5cd30"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4176, 100, 284, 4, 67, "Section",ExpressionUUID->"80570d05-3acc-47ce-baa9-22353866f662"],
Cell[CellGroupData[{
Cell[4485, 108, 227, 4, 45, "Subsubsection",ExpressionUUID->"58bc4453-c91b-4b88-ad40-0dc4d28661b2"],
Cell[4715, 114, 714, 15, 30, "Input",ExpressionUUID->"1afe8aa8-9514-410e-892c-0cf5a7fbd55c"],
Cell[5432, 131, 670, 14, 30, "Input",ExpressionUUID->"7b8fa453-69a8-4b98-a8a9-11d87b665293"],
Cell[6105, 147, 229, 6, 35, "Text",ExpressionUUID->"84339a21-566d-4d12-96c2-fa5c6f86e96c"],
Cell[6337, 155, 139, 2, 30, "Input",ExpressionUUID->"b6ef50fc-6a0e-46f2-b63f-d12e5f7957e8"],
Cell[6479, 159, 305, 8, 30, "Input",ExpressionUUID->"c08f55d6-f8a4-4a80-b9d6-b9f58dd34e53"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6821, 172, 221, 4, 45, "Subsubsection",ExpressionUUID->"88fe139b-10ca-4dcc-848e-4db4e8000a0d"],
Cell[7045, 178, 544, 15, 33, "Input",ExpressionUUID->"c78a8584-496a-4d23-8ebe-4221ea6308a8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7626, 198, 166, 3, 45, "Subsubsection",ExpressionUUID->"18970398-d1a7-46b0-953f-e09ecfab1d7b"],
Cell[7795, 203, 687, 16, 52, "Input",ExpressionUUID->"f80e052e-3609-4cd6-b56f-145f27df9764"],
Cell[8485, 221, 3814, 75, 115, "Input",ExpressionUUID->"67b1c366-1bfa-4da0-8666-58eb3bf757f1"],
Cell[12302, 298, 2150, 50, 115, "Input",ExpressionUUID->"777320bd-9980-4c84-91ea-356e0c4cd599"],
Cell[14455, 350, 7169, 129, 178, "Input",ExpressionUUID->"09bab2ae-e32b-4534-b228-96d1e1ff7508"],
Cell[21627, 481, 909, 22, 52, "Input",ExpressionUUID->"c1acfe0a-5f1c-40cd-aed9-0ab85295b837"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22573, 508, 217, 4, 54, "Subsection",ExpressionUUID->"3f95a7e2-ce47-4e50-9fa0-e09c62b4aa2f"],
Cell[22793, 514, 211, 3, 35, "Text",ExpressionUUID->"d290c44c-76ff-44a7-9e40-d5d1b5362142"],
Cell[23007, 519, 1331, 26, 52, "Input",ExpressionUUID->"917abcdd-fb66-4abf-a759-5a4d08abb09d"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[24387, 551, 326, 6, 67, "Section",ExpressionUUID->"0a17baf7-3afa-40d1-a57b-c0bdcfae807e"],
Cell[24716, 559, 3312, 66, 220, "Input",ExpressionUUID->"a9e08290-df2b-4d34-8cb0-29a11e12976c"],
Cell[28031, 627, 1958, 40, 52, "Input",ExpressionUUID->"3a9707a8-d6a8-4ecb-9179-107402ae7397"],
Cell[29992, 669, 278, 6, 35, "Text",ExpressionUUID->"ede1dc63-9b6d-4734-9dbf-c38382bfa0dc"],
Cell[30273, 677, 1162, 33, 73, "Input",ExpressionUUID->"90c18d38-569b-4f12-baeb-3644809c0442"],
Cell[31438, 712, 532, 10, 58, "Text",ExpressionUUID->"d980a6d1-022c-44fd-a094-aff7bae9f427"],
Cell[31973, 724, 2981, 66, 199, "Input",ExpressionUUID->"ea0657d7-2e1f-4a2f-9c77-d30826f0f7e1"],
Cell[34957, 792, 472, 9, 58, "Text",ExpressionUUID->"a2805536-88a4-4f1d-b500-f8ec8a798c6d"],
Cell[35432, 803, 3414, 80, 304, "Input",ExpressionUUID->"4806304e-7e32-4eb9-98bf-a25a068bd67d"],
Cell[38849, 885, 788, 12, 30, "Input",ExpressionUUID->"2114e71b-5812-4cba-b31e-11e5df909e98"],
Cell[CellGroupData[{
Cell[39662, 901, 172, 3, 54, "Subsection",ExpressionUUID->"3de97194-515a-45a7-b83d-b94a2aec9b92"],
Cell[39837, 906, 1017, 22, 30, "Input",ExpressionUUID->"acb4c032-4d82-4034-9e61-e39d391950dd"],
Cell[40857, 930, 2686, 66, 81, "Input",ExpressionUUID->"1fd51d16-7f12-4950-b548-e36ab97d21a8"],
Cell[43546, 998, 524, 12, 30, "Input",ExpressionUUID->"b7b91fa9-e983-4b6a-a7a0-8e72c31ed7d8"],
Cell[44073, 1012, 503, 13, 30, "Input",ExpressionUUID->"b5690dd0-2a87-4650-a2ca-91c59ac92e4e"],
Cell[44579, 1027, 958, 28, 73, "Input",ExpressionUUID->"3d615338-a13f-4e8c-b2fc-93a8d980772d"],
Cell[45540, 1057, 2408, 64, 112, "Input",ExpressionUUID->"0a15e4ea-538c-4260-b9b0-f0419bdc7009"]
}, Open  ]],
Cell[CellGroupData[{
Cell[47985, 1126, 252, 4, 54, "Subsection",ExpressionUUID->"610a3bda-950d-4fab-80fc-db94fd9de434"],
Cell[48240, 1132, 7565, 197, 362, "Input",ExpressionUUID->"a7a78e0c-d8e6-491a-9656-7556de797ef5"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[55854, 1335, 503, 10, 105, "Section",ExpressionUUID->"a6c6cecc-e5ee-46b6-aea7-1dfe7d36a894"],
Cell[56360, 1347, 466, 8, 35, "Text",ExpressionUUID->"2001ab71-2a46-4a44-a30b-f64ff78f3b56"],
Cell[56829, 1357, 932, 22, 52, "Input",ExpressionUUID->"256186e6-68fc-4135-91f3-883a3fd19cec"],
Cell[57764, 1381, 174, 3, 35, "Text",ExpressionUUID->"0cafa278-4f29-459c-b3a1-785876889930"],
Cell[57941, 1386, 662, 15, 30, "Input",ExpressionUUID->"479e4a9e-37ca-4b9f-83ec-d20c79ea4013"],
Cell[58606, 1403, 207, 3, 30, "Input",ExpressionUUID->"597d9ec5-06e7-4f09-8eba-e3ddfbda108d"],
Cell[58816, 1408, 470, 9, 35, "Text",ExpressionUUID->"57117ee9-c8a9-4927-849b-80dd2f8ac348"],
Cell[59289, 1419, 730, 15, 52, "Input",ExpressionUUID->"a2c918e8-21f2-44a6-89f6-97053714f8a0"],
Cell[CellGroupData[{
Cell[60044, 1438, 217, 4, 54, "Subsection",ExpressionUUID->"1838855f-a32b-40be-86ee-a9b802aa26f2"],
Cell[60264, 1444, 6147, 162, 430, "Input",ExpressionUUID->"ca3f1a66-16c6-4498-8068-d000e0b0ac5d"],
Cell[66414, 1608, 3691, 92, 178, "Input",ExpressionUUID->"661c8f8a-3b4a-4486-9fd1-31b505dfbe15"],
Cell[70108, 1702, 378, 7, 30, "Input",ExpressionUUID->"84c214c2-09e2-4630-808c-96550b90ac42"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

